"use strict";(self.webpackChunkmatteocaldana=self.webpackChunkmatteocaldana||[]).push([[946],{5946:function(t,e,n){n.r(e),n.d(e,{default:function(){return z}});var r=n(9439),a=n(2791),o=n(201),i=n(8922),s=n(6442),c=n(5221),p=n(9961),u=n(9620),l=n(7626),h=n(6293),m=(n(3666),n(7762)),d=n(8559),f=n.n(d),g=(n(5804),n(5660),function(t){var e=(0,h.Sx)();return(0,a.useEffect)((function(){var n=f().control.fullscreen(t);return n.addTo(e),function(){var t,e,r,a=null!==(t=null===(e=n.getContainer())||void 0===e?void 0:e.getElementsByClassName("leaflet-control-zoom-fullscreen"))&&void 0!==t?t:[],o=(0,m.Z)(a);try{for(o.s();!(r=o.n()).done;){r.value.remove()}}catch(i){o.e(i)}finally{o.f()}}}),[]),null}),y=[{attribution:'&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors,<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",name:"OpenStreetMap",maxNativeZoom:19},{url:"https://{s}.tile.openstreetmap.de/{z}/{x}/{y}.png",maxNativeZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',name:"OpenStreetMap.DE"},{url:"https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",maxNativeZoom:20,attribution:'&copy; OpenStreetMap France | &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',name:"OpenStreetMap.FR"},{url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",maxNativeZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>',name:"OpenStreetMap.HOT"},{url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",maxNativeZoom:16,attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)',name:"OpenTopoMap"},{attribution:'<a href="https://wiki.openstreetmap.org/wiki/Hiking/mri">&copy; sly</a> MODIS/Terra Snow Cover 8-day by NSDIC | ASTER GDEM is a product of METI and NASA | SRTM V4 thanks to CGIAR-CSI<br>EU-DEM produced using Copernicus data and information funded by the European Union | Donn\xe9es <a href="http://www.openstreetmap.org/copyright">&copy; les contributeurs OpenStreetMap</a>',url:"https://maps.refuges.info/hiking/{z}/{x}/{y}.png",name:"OpenStreetMap Hike",maxNativeZoom:18},{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &amp; USGS',url:"http://tile.mtbmap.cz/mtbmap_tiles/{z}/{x}/{y}.png",name:"mtbmap",maxNativeZoom:18},{attribution:'Data by <a href="http://www.openstreetmap.org" target="_blank" title="OpenStreetMap.org">OpenStreetMap.org</a> contributors under <a href="http://creativecommons.org/licenses/by-sa/2.0/" target="_blank">CC BY-SA 2.0</a> license<em> | Tiles: \xa9 Toursprung GmbH</em>',url:"https://vtile01.maptoolkit.net/raster/toursprung/terrain/{z}/{x}/{y}.png",name:"toursprung",maxNativeZoom:19},{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",name:"Esri.WorldImagery",maxNativeZoom:24}],x=[{attribution:'&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors,<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',url:"https://tile.waymarkedtrails.org/hiking/{z}/{x}/{y}.png",name:"waymarkedtrails",maxNativeZoom:18},{attribution:'&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors,<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',url:"https://a.gps-tile.openstreetmap.org/lines/{z}/{x}/{y}.png",name:"GPS Tracks",maxNativeZoom:24}],v=n(184),b=function(t){var e=t.data;return e&&e[0]&&e[0].accuracy?1===e.length?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(i.c,{center:[e[0].latitude,e[0].longitude],radius:3}),(0,v.jsx)(s.C,{center:[e[0].latitude,e[0].longitude],radius:e[0].accuracy})]}):(0,v.jsx)(c.a,{positions:e.map((function(t){return[t.latitude,t.longitude]}))}):(0,v.jsx)(v.Fragment,{})},M=function(t){var e=t.center,n=(0,h.Sx)(),r=n.getCenter(),a=[r.lat-e[0],r.lng-e[1]];return a[0]*a[0]+a[1]*a[1]>.001&&n.setView(e,n.getZoom()),null},S=function(t){var e=t.data,n=t.hoverPointIdx,r=function(t){return t.map((function(t){return[t.latitude,t.longitude]})).reduce((function(t,e){return[t[0]+e[0],t[1]+e[1]]})).map((function(e){return e/t.length}))}(e);return(0,v.jsxs)(p.h,{center:r,zoom:13,style:{height:400,width:"100%"},children:[(0,v.jsx)(M,{center:r}),(0,v.jsx)(b,{data:e}),n&&(0,v.jsx)(i.c,{center:[e[n].latitude,e[n].longitude],radius:2}),(0,v.jsx)(g,{}),(0,v.jsxs)(u.et,{position:"topright",children:[y.map((function(t,e){return(0,v.jsx)(u.et.BaseLayer,{checked:0===e,name:t.name,children:(0,v.jsx)(l.I,{attribution:t.attribution,url:t.url})},e)})),x.map((function(t,e){return(0,v.jsx)(u.et.Overlay,{name:t.name,children:(0,v.jsx)(l.I,{attribution:t.attribution,url:t.url})},e)}))]})]})},w=n(3433),j=n(1413),Z=n(2212),A=n(5849),k=n(5596),O=function(t){return.017453292519943295*t},E=function(t,e){var n=function(t){var e=6378137,n=6371001,r=e*Math.cos(t),a=n*Math.sin(t),o=Math.pow(e*r,2)+Math.pow(n*a,2),i=Math.pow(r,2)+Math.pow(a,2);return Math.sqrt(o/i)}((t.latRad+e.latRad)/2),r=e.latRad-t.latRad,a=e.lonRad-t.lonRad,o=Math.sin(r/2)*Math.sin(r/2)+Math.cos(t.latRad)*Math.cos(e.latRad)*Math.sin(a/2)*Math.sin(a/2);return n*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))};var C=function(t,e){return t.getElementsByTagName(e)[0].innerHTML},T=function(t){var e;return Array.from(t.getElementsByTagName("trkpt")).map((function(t,n){var r=new Date(C(t,"time")),a=Object.fromEntries(["ele","course","hAcc","vAcc","speed"].map((function(e){return[e,parseFloat(C(t,e))]}))),o=["lat","lon"].map((function(e){return parseFloat(t.getAttribute(e))})),i=(0,j.Z)((0,j.Z)({},a),{},{hAccuracy:a.hAcc,vAccuracy:a.vAcc,accuracy:Math.sqrt(a.hAcc*a.hAcc+a.vAcc*a.vAcc),latitude:o[0],longitude:o[1],latRad:O(o[0]),lonRad:O(o[1]),date:r,timestamp:r.getTime(),activeTime:n});if(n>0){var s=function(t,e){var n=E(t,e),r=Math.abs(e.ele-t.ele);return{dist:Math.sqrt(Math.pow(n,2)+Math.pow(r,2)),steep:r/n}}(i,e),c=s.dist,p=s.steep;i.distance=e.distance+c,i.steepness=isFinite(p)?100*p:0}else i.dist3d=0,i.distVi=0,i.speed3d=0,i.steepness=0,i.distance=i.speed;return e=i,i}))},I=function(t){var e=t.setData,n=(0,a.useState)(null),o=(0,r.Z)(n,2),i=o[0],s=o[1];return(0,a.useEffect)((function(){i&&i.text().then((function(t){for(var n=(new DOMParser).parseFromString(t,"text/xml"),r=T(n),a=["ele","speed","accuracy"],o=(0,Z.tq)(r.length,90),i=Object.fromEntries(["speed","steepness"].map((function(t){return["".concat(t),(0,Z.BX)(r.map((function(e){return e[t]})),o)]}))),s=Object.fromEntries(a.map((function(t){return[t,[Math.min.apply(Math,(0,w.Z)(r.map((function(e){return e[t]})))),Math.max.apply(Math,(0,w.Z)(r.map((function(e){return e[t]}))))]]}))),c=[],p=function(t){var e=Object.fromEntries(a.map((function(e){return["".concat(e,"_norm"),(r[t][e]-s[e][0])/(s[e][1]-s[e][0])]})));c.push((0,j.Z)((0,j.Z)({},r[t]),e)),Object.entries(i).forEach((function(e){c[t][e[0]]=e[1][t]}))},u=0;u<r.length;++u)p(u);e(c)}))}),[i]),(0,v.jsxs)(A.Z,{variant:"outlined",color:"info",endIcon:(0,v.jsx)(k.Z,{}),component:"label",style:{alignItems:"center",display:"flex",marginBottom:10},children:["Upload GPX Track",(0,v.jsx)("input",{onChange:function(t){return s(t.target.files.item(0))},type:"file",accept:".gpx",hidden:!0})]})},N=n(8286),R=function(t){var e=t.data,n=t.setHoverPointIdx;return(0,v.jsx)(N.Z,{data:(0,w.Z)(["ele","steepness","speed"].map((function(t,n){return{x:e.map((function(t){return t.date})),y:e.map((function(e){return e[t]})),type:"plot",mode:"lines",hoverinfo:"x+y",name:t,yaxis:n>0?"y".concat(n+1):void 0}}))),layout:{margin:{l:60,r:150,t:20,b:40},legend:{x:1.2,xanchor:"right",y:1},hovermode:"x",xaxis:{showspikes:!0,spikemode:"across+toaxis",spikecolor:"black",spikethickness:2},uirevision:"true",yaxis:{title:"",titlefont:{color:"#1f77b4"},tickfont:{color:"#1f77b4"}},yaxis2:{title:"",titlefont:{color:"#ff7f0e"},tickfont:{color:"#ff7f0e"},overlaying:"y",side:"left",position:.005},yaxis3:{title:"",titlefont:{color:"#2ca02c"},tickfont:{color:"#2ca02c"},overlaying:"y",side:"right"},updatemenus:[{buttons:[{args:[{x:Array(3).fill(e.map((function(t){return t.date})))}],label:"Time",method:"update"},{args:[{x:Array(3).fill(e.map((function(t){return t.distance})))}],label:"Space",method:"update"}],direction:"left",pad:{r:10,t:10},showactive:!0,type:"buttons",x:.1,xanchor:"left",y:1.1,yanchor:"top"}]},config:{displayModeBar:!1},onHover:function(t){return n(t.points[0].pointIndex)},onUnhover:function(){return n(void 0)},style:{width:"100%"}})},G=function(t){var e=t.geolocation;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("h4",{children:"Geolocation Data:"}),e.error?(0,v.jsx)("p",{children:"Geolocation is not available, sorry."}):(0,v.jsxs)("ul",{style:{columns:2},children:[(0,v.jsxs)("li",{children:["Latitude: ",e.latitude," \xb1 ",Math.round(e.accuracy)]}),(0,v.jsxs)("li",{children:["Longitude: ",e.longitude," \xb1 ",Math.round(e.accuracy)]}),(0,v.jsxs)("li",{children:["Altitude: ",e.altitude," \xb1 ",e.altitudeAccuracy]}),(0,v.jsxs)("li",{children:["Heading: ",e.heading]}),(0,v.jsxs)("li",{children:["Speed: ",e.speed]}),(0,v.jsxs)("li",{children:["Timestamp: ",e.timestamp]})]})]})},z=function(){var t=(0,o.Z)({enableHighAccuracy:!0}),e=(0,a.useState)([{latitude:45.4642,longitude:9.19}]),n=(0,r.Z)(e,2),i=n[0],s=n[1],c=(0,a.useState)(void 0),p=(0,r.Z)(c,2),u=p[0],l=p[1];return(0,a.useEffect)((function(){1===i.length&&!t.error&&t.latitude&&s([t])}),[t]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(G,{geolocation:t}),(0,v.jsx)(I,{setData:s}),(0,v.jsx)(S,{data:i,hoverPointIdx:u}),i&&i.length>1&&(0,v.jsx)(R,{data:i,setHoverPointIdx:l})]})}},2212:function(t,e,n){n.d(e,{BX:function(){return i},RJ:function(){return c},tq:function(){return s}});var r=n(3433),a=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(t<e)for(var a=t;a<e;a+=n)r.push(a);else for(var o=t;o>e;o+=n)r.push(o);return r},o=function(t,e){for(var n=0,r=0;r<t.length;++r)n+=t[r]*e[r];return n},i=function(t,e){for(var n=e.length,r=t.length,a=Math.trunc(n/2),i=[],s=0;s<r;++s){var c=e.slice(a-s,a-s+r);i.push(o(c,t)/c.reduce((function(t,e){return t+e}),0))}return i},s=function(t,e){return[].concat((0,r.Z)(Array(t-e+1).fill(0)),(0,r.Z)(a(1,e)),(0,r.Z)(a(e,0,-1)),(0,r.Z)(Array(t-e+1).fill(0)))},c=function(t,e){return[].concat((0,r.Z)(a(t,0,-1).map((function(t){return Math.pow(e,t)}))),(0,r.Z)(a(0,t+1).map((function(t){return Math.pow(e,t)}))))}}}]);
//# sourceMappingURL=946.78cf2ae5.chunk.js.map